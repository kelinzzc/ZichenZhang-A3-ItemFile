<div class="events-page" ng-controller="EventsController as vm">
    <!-- 页面标题和操作 -->
    <div class="page-header">
        <div class="header-left">
            <h1>活动管理</h1>
            <p>管理所有慈善活动</p>
        </div>
        <div class="header-right">
            <button class="btn btn-primary" ng-click="vm.createEvent()">
                <i class="fas fa-plus"></i>
                创建新活动
            </button>
        </div>
    </div>

    <!-- 搜索和筛选 -->
    <div class="search-section">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" 
                   ng-model="vm.searchQuery" 
                   ng-change="vm.searchEvents()"
                   placeholder="搜索活动名称、描述或地点...">
        </div>
    </div>

    <!-- 加载状态 -->
    <div ng-if="vm.isLoading" class="loading-state">
        <div class="spinner"></div>
        <p>加载活动中...</p>
    </div>

    <!-- 活动列表 -->
    <div ng-if="!vm.isLoading" class="content-section">
        <div class="card">
            <div class="card-body">
                <!-- 数据表格 -->
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>活动名称</th>
                            <th>类别</th>
                            <th>日期</th>
                            <th>地点</th>
                            <th>状态</th>
                            <th>注册人数</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="event in vm.filteredEvents | 
                                      limitTo: vm.pagination.itemsPerPage : 
                                      (vm.pagination.currentPage - 1) * vm.pagination.itemsPerPage">
                            <td>
                                <strong>{{event.title}}</strong>
                                <div class="text-muted small">{{event.description}}</div>
                            </td>
                            <td>{{event.category_name}}</td>
                            <td>{{vm.formatDate(event.event_date)}}</td>
                            <td>{{event.location}}</td>
                            <td>
                                <span class="status-badge" 
                                      ng-class="vm.getEventStatus(event).class">
                                    {{vm.getEventStatus(event).text}}
                                </span>
                            </td>
                            <td>
                                {{event.total_tickets_sold || 0}} / {{event.max_attendees}}
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn btn-sm btn-info" 
                                            ng-click="vm.viewEvent(event)"
                                            title="查看详情">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" 
                                            ng-click="vm.editEvent(event)"
                                            title="编辑">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" 
                                            ng-click="vm.deleteEvent(event)"
                                            title="删除">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- 空状态 -->
                <div ng-if="vm.filteredEvents.length === 0" class="empty-state">
                    <i class="fas fa-calendar-times"></i>
                    <h3>暂无活动</h3>
                    <p>还没有创建任何活动，点击"创建新活动"开始添加</p>
                    <button class="btn btn-primary" ng-click="vm.createEvent()">
                        创建新活动
                    </button>
                </div>

                <!-- 分页 -->
                <div ng-if="vm.filteredEvents.length > 0" class="pagination">
                    <div class="pagination-info">
                        显示第 {{(vm.pagination.currentPage - 1) * vm.pagination.itemsPerPage + 1}} 
                        到 {{Math.min(vm.pagination.currentPage * vm.pagination.itemsPerPage, vm.pagination.totalItems)}} 条，
                        共 {{vm.pagination.totalItems}} 条记录
                    </div>
                    <div class="pagination-controls">
                        <button class="btn btn-sm" 
                                ng-disabled="vm.pagination.currentPage === 1"
                                ng-click="vm.pagination.currentPage = vm.pagination.currentPage - 1">
                            上一页
                        </button>
                        <span class="page-numbers">
                            第 {{vm.pagination.currentPage}} 页
                        </span>
                        <button class="btn btn-sm"
                                ng-disabled="vm.pagination.currentPage * vm.pagination.itemsPerPage >= vm.pagination.totalItems"
                                ng-click="vm.pagination.currentPage = vm.pagination.currentPage + 1">
                            下一页
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>